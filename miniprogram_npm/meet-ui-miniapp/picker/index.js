Component({options:{addGlobalClass:!0},properties:{type:{type:String,value:"normal"},trigger:{type:String,value:"field"},title:{type:String,value:"请选择"},placeholder:{type:String,value:"请选择"},confirmText:{type:String,value:"确认"},cancelText:{type:String,value:"取消"},confirmColor:{type:String,value:"#07c16c"},cancleColor:{type:String,value:"#333333"},items:{type:Array,value:[[]]},visibleItems:{type:Number,value:5},selectedValue:{type:Array,optionalTypes:[String],value:[0,0,0]},selectedIndex:{type:Array,optionalTypes:[Number],value:[0,0,0]},selectedText:{type:String,value:""},disabled:{type:Boolean,value:!1},showDelete:{type:Boolean,value:!1},bgColor:{type:String,value:"#fff"}},data:{visible:!1,columns:[],formatSelect:[]},observers:{items(e){this.columns="";var t=this.data["selectedIndex"];let s=[];0!==e.length&&Array.isArray(e[0])?s=e:s.push(e);e=this.formatItems(s.concat(),t);e&&this.setData({columns:e})},selectedValue(e){var s=this.formatValue(e),l=this.data["columns"];if(0<l?.length){const i=[];for(let t=0;t<=l.length-1;t++)for(let e=0;e<=l[t].length-1;e++){if(s[t]===l[t][e].value){i.push(e);break}e===l[t].length-1&&i.push(0)}this.setData({selectedIndex:i})}},selectedIndex(e){const l=this.formatValue(e);if(0!==l.length&&"normal"===this.data.type){const t=this.formatItems(this.data.items.concat(),this.data.selectedIndex);if(t&&0!==t[0].length){let s="";t.map((e,t)=>s+=e[l[t]]?.label),this.setData({selectedText:s,formatSelect:l})}}}},methods:{setColumnItems(e,t,s=!0){const l=this.getColumn(e);if(null===l)return Promise.reject(new Error("setColumnItems: 对应列不存在"));if(JSON.stringify(l.data.items)===JSON.stringify(t))return Promise.resolve();let i=s?{items:t,currentIndex:0,offset:0}:{items:t};return l._setData(i).then(()=>{})},handlBtn(e){e=e.currentTarget.dataset.type;if("confirm"===e&&(this.triggerEvent(e,{index:this.getIndexes(),value:this.getValues()}),"normal"===this.data.type)){const t=[];this.getValues().map(e=>{t.push(e.label)}),this.setData({selectedText:t.join("")})}this.setVisible()},setVisible(){var{visible:e,disabled:t}=this.data;t?this.triggerEvent("disable"):this.setData({visible:!e})},handleChange(e){var{columnIndex:e,item:t}=e.detail;0===e&&t.children?(t.children[0].children&&this.setColumnItems(2,t.children[0].children,!0),this.setColumnItems(1,t.children,!0)):1===e&&t.children&&this.setColumnItems(2,t.children,!0),this.triggerEvent("change",{picker:this,columnIndex:e,index:this.getIndexes(),item:this.getValues()})},getIndexes(){return this.children.map(e=>e.data.currentIndex)},getValues(){return this.children.map(e=>e.getValue())},getColumn(e){return this.children[e]},formatItems(e,t){var s;if(0!==e.length)return this.columns||((s=e[0][t[0]])&&s.children&&(e.push(s.children),(s=s.children[t[1]])?.children&&e.push(s.children)),this.columns=e)},handleDelete(){const e=this.data["columns"];e.map((e,t)=>{this.getColumn(t).setIndex(0)}),this.setData({selectedText:""}),this.triggerEvent("delete")},formatValue(e){let t=[];return Array.isArray(e)?t=e:t.push(e),t}},lifetimes:{created(){Object.defineProperty(this,"children",{get:()=>this.selectAllComponents(".mt-picker__column")||[]})}}});