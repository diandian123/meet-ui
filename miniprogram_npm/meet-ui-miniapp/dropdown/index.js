let MENU_ITEM=[],MENU_INDEX=0;Component({options:{addGlobalClass:!0,multipleSlots:!0,styleIsolation:"shared"},properties:{scene:{type:String,value:"page"},type:{type:String,value:"radio"},title:{type:Array,value:[]},position:{type:String,value:"left"},items:{type:Array,value:[]},current:{type:Array,optionalTypes:[Number],value:[]},changeTitle:{type:Boolean,value:!0},topClosable:{type:Boolean,value:!0},bottomDistance:{type:Number,value:100},disabled:{type:Boolean,value:!1}},data:{activeIndex:-1,formatValue:[],formatcurrent:[]},observers:{items(t){t=this.formatValue(t);this.setData({formatValue:t},()=>{this.getAllItems()})},current(t){const e=this.formatCurrent(t),{formatValue:a,changeTitle:s,type:i,title:r}=this.data;!s||"radio"!==i&&"relation"!==i||(t=e.map((t,e)=>a[e][t]?.label||r[e]),this.setData({title:t})),this.setData({formatcurrent:e})},type(t){"custom"===t&&this.setData({formatValue:this.data.title})}},methods:{showPopup(t){var e=this.data["disabled"];e||(e=t.currentTarget.dataset["index"],MENU_ITEM.forEach(t=>{t&&t!==this&&t.data.nodes[MENU_INDEX]?.closePopup(0)}),MENU_INDEX=e,this.getPostation(e))},targetPopup(t=0,e){var a=this.data["activeIndex"];const s=this.data.nodes[a],i=this.data.nodes[t];this.currItem=i,-1!==a&&a!==t&&(this.setData({activeIndex:-1}),s.closePopup(0)),a===t?i.closePopup():(this.setData({activeIndex:t}),i.setDropdown(),i.setPosition(e))},getPostation(e){const t=this.createSelectorQuery();t.select(".mt-dropdown").boundingClientRect(t=>{this.targetPopup(e,t)}).exec()},resetActive(){this.setData({activeIndex:-1})},handleClose(){MENU_INDEX=0,this.triggerEvent("close")},handleClick(t){var{item:t,targetClick:e}=t.detail;e&&(MENU_INDEX=0),this.selectList[MENU_INDEX]=t,"relation"===this.data.type?this.triggerEvent("click",{item:this.selectList[MENU_INDEX],MENU_INDEX:MENU_INDEX}):this.triggerEvent("click",{item:this.selectList,MENU_INDEX:MENU_INDEX})},stopEvent(){},getAllItems(){var t=this.selectAllComponents(".mt-dropdown__menu");const{formatValue:e,formatcurrent:a,type:s}=this.data;this.selectList=e.map((e,t)=>{return 0===a.length?null:1===a[t].length?"checkbox"===s?[e[a[t]]]:e[a[t]]:a[t].map(t=>e[t])}),this.setData({nodes:t})},setTitle(t){var e=this.data["activeIndex"],t=t.detail;-1!==e&&this.setData({[`title[${e}]`]:t})},formatValue(t){let e=[];return 0!==t.length&&Array.isArray(t[0])?e=t:e.push(t),e},formatCurrent(t){var{type:e,title:a}=this.data;let s=[];return("radio"===e||"relation"===e)&&1<a.length?s=t.map(t=>[t]):"radio"===e||"relation"===e?s.push([t]):s=t,s}},lifetimes:{created(){MENU_ITEM.push(this)},detached(){MENU_ITEM=MENU_ITEM.filter(t=>t!==this)},ready(){this.selectList=[],this.getAllItems()}}});