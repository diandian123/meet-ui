const ITEMSKEYS=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","W","X","Y","Z"];Component({options:{addGlobalClass:!0,multipleSlots:!0,styleIsolation:"shared"},properties:{type:{type:String,value:"list"},title:{type:String,value:""},items:{type:Array,value:[]},hasSticky:{type:Boolean,value:!0},hasSafe:{type:Boolean,value:!0},avatarSize:{type:String,value:"l"},hasDelete:{type:Boolean,value:!1},hasSelect:{type:Boolean,value:!1}},data:{treeInfo:{treeTop:0,treeBottom:0,itemHeight:0,itemMount:0},formatItems:[],maxScrollTop:0,blocks:[],treeItemCur:0,listItemCur:0,touching:!1,scrollTop:0,treeKeyTran:!1,lastScrollTop:0},observers:{items(t){0!==t.length&&(this.formatItems(t),this.init())}},methods:{formatItems(a){const i=[];ITEMSKEYS.forEach(e=>{const t={};t.key=e,t.data=a.map((t,e)=>({index:e,...t})).filter(t=>t.key===e),t.data&&0<t.data.length&&i.push(t)}),this.setData({formatItems:i})},init(){this.data.hasDelete||this.data.hasSelect?this.getScrollTop():this.clearData(),0!==this.data.formatItems.length&&this.initDom()},initDom(){const t=this.createSelectorQuery();t.select(".mt-indexlist__tree").boundingClientRect(),t.select(".mt-indexlist__content").boundingClientRect(),t.select(".mt-indexlist__main").boundingClientRect(),t.selectAll(".mt-indexlist__groups").boundingClientRect(),t.exec(t=>{let i=-1;var e=t[0].top,a=t[0].top+t[0].height,s=t[0].height/this.data.formatItems.length,o=this.data.formatItems.length,r=t[1]["bottom"];const l=t[2]["top"],h=t[2].height+t[2].top-r+this.data.lastScrollTop;r=t[3].map((t,e)=>{var a=Math.ceil(t.top-l),t=Math.ceil(a+t.height);return h>=a&&h<t&&(i=e),{itemTop:a,itemBottom:t,scrollTop:a>=h?h:a,scrollIndex:-1===i?e:i}});this.setData({maxScrollTop:h,blocks:r,treeInfo:{treeTop:e,treeBottom:a,itemHeight:s,itemMount:o}})})},handleClick(t){var t=t.currentTarget.dataset["index"],e=this.data.items[t];this.data.hasSelect?this.triggerEvent("select",{index:t,item:e}):this.triggerEvent("click",{index:t,item:e})},handleDelete(t){var t=t.currentTarget.dataset["index"],e=this.data.items[t];this.triggerEvent("delete",{index:t,item:e})},handleScroll(t){if(!this.data.touching){var e=t.detail.scrollTop;if(!(e>this.data.maxScrollTop)){var a=this.data.blocks;for(let t=a.length-1;0<=t;t--){var i=a[t];(this.scrollTop=e)>=i.itemTop&&e<i.itemBottom&&this.setData({treeItemCur:t,listItemCur:t})}}}},touchStart(t){var t=t.changedTouches[0];t&&(this.setData({touching:!0}),t=this.getCurrentTreeItem(t.clientY),this.setValue(t),wx.vibrateShort())},touchMove(t){var t=t.changedTouches[0];t&&(this.data.touching||this.setData({touching:!0}),t=this.getCurrentTreeItem(t.clientY),this.setValue(t))},touchEnd(){var{treeItemCur:t,listItemCur:e}=this.data;t!==e&&this.setData({treeItemCur:e}),this.setData({treeKeyTran:!0}),setTimeout(()=>{this.setData({touching:!1,treeKeyTran:!1})},300)},getCurrentTreeItem(t){var{treeTop:e,treeBottom:a,itemHeight:i,itemMount:s}=this.data.treeInfo;return t<e?0:a<=t?s-1:Math.floor((t-e)/i)},setValue(t){var e,a;t!==this.data.treeItemCur&&(e=this.data.blocks[t])&&({scrollTop:e,scrollIndex:a}=e,this.setData({treeItemCur:t,scrollTop:e,listItemCur:a},()=>{wx.vibrateShort()}))},clearData(){this.setData({treeItemCur:0,listItemCur:0,touching:!1,scrollTop:0,treeKeyTran:!1})},getScrollTop(){this.setData({lastScrollTop:this.scrollTop||0})}}});